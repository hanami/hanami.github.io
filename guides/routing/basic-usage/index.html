<!doctype html>
<html class="no-js" lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Lotus - Guides - Basic Usage</title>
    <meta name="description" content="Lotus, a complete web framework for Ruby" />
    <meta name="keywords" content="lotus,web,framework,ruby,open source,oss,os,software,free,free software,architecture,fast,lightweight,testing,tdd,bdd,test driven development,behaviour driven development,full stack,mvc,model view object,pattern,patterns,design patterns,oop,object oriented programming,testability,http,https,routing,router,http router,restful,resource,resources,convention,controller,models,repository,query,sql,interactors,two-step view,view,template,presenters,render,rendering,helpers,erb,haml,tilt,json,xml,yaml,yml,framwork,framewrok,riby,free sowftare"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="http://feeds.feedburner.com/lotusrb" rel="alternate" title="Lotus" type="application/atom+xml" />

    <link href="/stylesheets/application.css" rel="stylesheet" type="text/css" />

    <script src="//use.typekit.net/xhp5wmc.js"></script>
    <script>try{Typekit.load();}catch(e){}</script>
  </head>
  <body class="subpage docs">
    <!--[if lt IE 8]>
<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
<![endif]-->

<nav class="navbar navbar-fixed-top container-fluid">
  <div class="wrapper container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Logo</a>
    </div>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <!-- <li><a href="/guides">Guides</a></li> -->
        <li><a href="/community">Community</a></li>
        <li><a href="/blog">Blog</a></li>
        <li><a href="https://rubygems.org/gems/lotusrb" id="nav-link-install" target="_blank" class="btn btn-primary version">Install v0.3.1</a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</nav>


    <section class="docs wrapper animated fadeIn">
      <div class="container-fluid">
        <div class="row">
          <div class="col-md-3 hidden-sm hidden-xs sidebar">
            <ul class="nav nav-sidebar">
              <li>
                <span class="heading">Routing</span>
                <ul class="nav">
                  <li><a href="/guides/routing/overview">Overview</a></li>
                  <li><a href="/guides/routing/basic-usage">Basic Usage</a></li>
                  <li><a href="/guides/routing/restful-resources">RESTful Resource(s)</a></li>
                </ul>
              </li>

              <li>
                <span class="heading">Actions</span>
                <ul class="nav">
                  <li><a href="/guides/actions/overview">Overview</a></li>
                  <li><a href="/guides/actions/basic-usage">Basic Usage</a></li>
                  <li><a href="/guides/actions/parameters">Parameters</a></li>
                  <li><a href="/guides/actions/request-and-response">Request & Response</a></li>
                  <li><a href="/guides/actions/exposures">Exposures</a></li>
                  <li><a href="/guides/actions/rack-integration">Rack Integration</a></li>
                  <li><a href="/guides/actions/mime-types">MIME Types</a></li>
                  <li><a href="/guides/actions/cookies">Cookies</a></li>
                  <li><a href="/guides/actions/sessions">Sessions</a></li>
                  <li><a href="/guides/actions/exceptions">Exceptions</a></li>
                  <li><a href="/guides/actions/flow-control">Flow Control</a></li>
                  <li><a href="/guides/actions/http-caching">HTTP Caching</a></li>
                  <li><a href="/guides/actions/configuration">Configuration</a></li>
                  <li><a href="/guides/actions/share-code">Share Code</a></li>
                  <li><a href="/guides/actions/testing">Testing</a></li>
                </ul>
              </li>

              <li>
                <span class="heading">Command Line</span>
                <ul class="nav">
                  <li><a href="/guides/command-line/routes">Routes</a></li>
                </ul>
              </li>
            </ul>

          </div>

          <div class="col-md-9 main">
            <div class="doc-section">
              <a href="https://github.com/lotus/lotus.github.io/edit/build//source/guides/routing/basic-usage.md" id="edit-guides-article" title="Edit this article" target="_blank">edit</a>
              <h1>Basic Usage</h1>

<h2>Path matching</h2>

<p>In <a href="/guides/routing/overview">our initial example</a> we have introduced a really basic relative URI: <code>/hello</code>.
This is what we call a <em>fixed path matching</em>.
The reason is that the segment is responsible to respond only to the <strong>exact match</strong>.
If we visit <code>/hello</code>, we get a response.
If we hit <code>/foo</code>, a <code>404</code> (Not Found) is returned.</p>

<h3>Fixed Matching</h3>
<pre class="language-ruby ruby"><code><span class="c1"># apps/web/config/routes.rb</span>
<span class="n">get</span> <span class="s1">'/dashboard'</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"dashboard#index"</span>
</code></pre>

<h3>Variables</h3>

<p>When we have dynamic content to serve, we want our URI to be dynamic as well.
This can be easily achieved via path variables.
They are defined with a colon, followed by a name (eg. <code>:id</code>).</p>

<p>Once an incoming request is forwarded to our endpoint, we can access the current value in our param&rsquo;s action (<code>params[:id]</code>).</p>
<pre class="language-ruby ruby"><code><span class="n">get</span> <span class="s1">'/books/:id'</span><span class="p">,</span> <span class="ss">to: </span><span class="s1">'books#show'</span>
</code></pre>

<p>Multiple variables can be used in a path.</p>
<pre class="language-ruby ruby"><code><span class="n">get</span> <span class="s1">'/books/:book_id/reviews/:id'</span><span class="p">,</span> <span class="ss">to: </span><span class="s1">'reviews#show'</span>
</code></pre>

<h3>Variables Constraints</h3>

<p>It&rsquo;s possible to specify constraints for each variable.
The rule MUST be expressed as a regular expression.
If a request can satisfy all of them, we&rsquo;re good, otherwise a <code>404</code> is returned.</p>
<pre class="language-ruby ruby"><code><span class="n">get</span> <span class="s1">'/authors/:id'</span><span class="p">,</span> <span class="ss">id: </span><span class="sr">/\d+/</span><span class="p">,</span> <span class="ss">to: </span><span class="s1">'authors#show'</span>
</code></pre>

<h3>Optional Tokens</h3>

<p>Sometimes we want to specify an optional token as part of our URI.
It should be expressed between round parenthesis.
If present, it will be available as param in the Rack env, otherwise it will be missing, but the endpoint will be still hit.</p>
<pre class="language-ruby ruby"><code><span class="n">get</span> <span class="s1">'/books(.:format)'</span><span class="p">,</span> <span class="ss">to: </span><span class="s1">'books#show'</span>
</code></pre>

<h3>Wildcard Matching</h3>

<p>Imagine to serve static files from a user repository.
It would be impossible to know in advance which files are stored and to prepare routes accordingly.</p>

<p>To solve this problem, Lotus supports <em>wildcard matching</em>.</p>
<pre class="language-ruby ruby"><code><span class="n">get</span> <span class="s1">'/files/*'</span><span class="p">,</span> <span class="ss">to: </span><span class="s1">'files#show'</span>
</code></pre>

<h2>Named Routes</h2>

<p>We can specify an unique name for each route, in order to generates paths from the router or to test them.</p>
<pre class="language-ruby ruby"><code><span class="n">get</span> <span class="s1">'/hello'</span><span class="p">,</span>     <span class="ss">to: </span><span class="s1">'greet#index'</span><span class="p">,</span> <span class="ss">as: :greeting</span>
<span class="n">get</span> <span class="s1">'/books/:id'</span><span class="p">,</span> <span class="ss">to: </span><span class="s1">'books#show'</span><span class="p">,</span>  <span class="ss">as: :book</span>
</code></pre>

<p>When a Lotus application starts, it generates a Ruby module at the runtime under our application namespace: eg. <code>Web::Routes</code>.
We can use it to generate a relative or absolute URI for our route.</p>
<pre class="language-ruby ruby"><code><span class="no">Web</span><span class="o">::</span><span class="no">Routes</span><span class="p">.</span><span class="nf">path</span><span class="p">(</span><span class="ss">:greeting</span><span class="p">)</span> <span class="c1"># =&gt; "/hello"</span>
<span class="no">Web</span><span class="o">::</span><span class="no">Routes</span><span class="p">.</span><span class="nf">url</span><span class="p">(</span><span class="ss">:greeting</span><span class="p">)</span>  <span class="c1"># =&gt; "http://localhost:2300/hello"</span>
</code></pre>

<p>When we have one or more variables, they can be specified as a Hash.</p>
<pre class="language-ruby ruby"><code><span class="no">Web</span><span class="o">::</span><span class="no">Routes</span><span class="p">.</span><span class="nf">path</span><span class="p">(</span><span class="ss">:book</span><span class="p">,</span> <span class="ss">id: </span><span class="mi">1</span><span class="p">)</span> <span class="c1"># =&gt; "/books/1"</span>
<span class="no">Web</span><span class="o">::</span><span class="no">Routes</span><span class="p">.</span><span class="nf">url</span><span class="p">(</span><span class="ss">:book</span><span class="p">,</span> <span class="ss">id: </span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># =&gt; "http://localhost:2300/books/1"</span>
</code></pre>

<p>Absolute URL generation is dependent on <code>scheme</code>, <code>host</code> and <code>port</code> settings in <code>apps/web/application.rb</code>.</p>

<h3>Routing Helpers</h3>

<p>Generating routes from <code>Web::Routes</code> is helpful, because that module can be accessed from everywhere.
However, this syntax is noisy.</p>

<p>Lotus has <em>routing helpers</em> available as <code>routes</code> in: <strong>actions</strong>, <strong>views</strong> and <strong>templates</strong>.</p>
<pre class="language-ruby ruby"><code><span class="o">&lt;</span><span class="sx">%= routes.path(:greeting) %&gt;
&lt;%=</span> <span class="n">routes</span><span class="p">.</span><span class="nf">url</span><span class="p">(</span><span class="ss">:greeting</span><span class="p">)</span> <span class="o">%&gt;</span>
</code></pre>

<p>Or</p>
<pre class="language-ruby ruby"><code><span class="o">&lt;</span><span class="sx">%= routes.greeting_path %&gt;
&lt;%=</span> <span class="n">routes</span><span class="p">.</span><span class="nf">greeting_url</span> <span class="sx">%&gt;
</span></code></pre>

<h2>Namespaces</h2>

<p>If we want to group a set of resources under a common prefix we can use <code>namespace</code>.</p>
<pre class="language-ruby ruby"><code><span class="n">namespace</span> <span class="s1">'docs'</span> <span class="k">do</span>
  <span class="n">get</span> <span class="s1">'/installation'</span><span class="p">,</span> <span class="ss">to: </span><span class="s1">'docs#installation'</span>
  <span class="n">get</span> <span class="s1">'/usage'</span><span class="p">,</span>        <span class="ss">to: </span><span class="s1">'docs#usage'</span>
<span class="k">end</span>

<span class="c1"># This will generate:</span>
<span class="c1">#</span>
<span class="c1">#   /docs/installation</span>
<span class="c1">#   /docs/usage</span>
</code></pre>

<h2>Redirects</h2>

<p>In case of legacy routes, we can handle HTTP redirects at the routing level.</p>
<pre class="language-ruby ruby"><code><span class="n">redirect</span> <span class="s1">'/old'</span><span class="p">,</span> <span class="ss">to: </span><span class="s1">'/new'</span>
</code></pre>

            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="email-signup">
  <div class="container-fluid wrapper">
    <form action="http://lotusrb.us3.list-manage.com/subscribe/post" method="POST" class="">
      <input name="u" value="dcbeefa4ba1ea9ae043857005" type="hidden">
      <input name="id" value="fb3873a90f" type="hidden">
      <input name="orig-lang" value="1" type="hidden">
      <input type="email" placeholder="Enter your email to get updates" spellcheck="false" autocapitalize="off" autocorrect="off" name="MERGE0" id="MERGE0" value="" class="pull-left">
      <button type="submit" class="btn btn-primary pull-right">Subscribe</button>
    </form>
  </div>
</section>

<footer class="primary">
  <div class="container-fluid wrapper">
    <div class="row">
      <a class="logo col-md-3" href="/">logo</a>
        <div class="col-md-4">
          <span class="date">May 15, 2015</span>
          <h4>Announcing Lotus v0.3.1</h4>
          <p>Lotus patch release: RESTful nested resource(s), dirty tracking and timestamps for entities, improved code generators, bug fixes.
</p>
          <a href="/blog/2015/05/15/announcing-lotus-031.html">Read more...</a>
        </div>
        <div class="col-md-4">
          <span class="date">May 15, 2015</span>
          <h4>Weekly Changelog</h4>
          <p>Changelog from Apr 28th to May 15th 2015
</p>
          <a href="/blog/2015/05/15/weekly-changelog.html">Read more...</a>
        </div>
    </div>
  </div>

  <div class="sub-footer wrapper">
    <p class="copyright pull-left">&copy; 2014-<span id="copyright-year">{{year}}</span> <a href="http://lucaguidi.com/">Luca Guidi</a> â€“ Lotus is released under the MIT License.
    <br>
    <br> This website and its contents are released under <a href="http://creativecommons.org/licenses/by-nc/4.0/" href="_blank">CC Attribution-NonCommercial 4.0</a>.
    <br> Maintained with <3 by the <a href="https://github.com/orgs/lotus/people" target="_blank">core team</a> with help from <a href="https://github.com/lotus/lotus/graphs/contributors" target="_blank">contributors</a>. Site Design by <a href="http://www.alantippins.com/">Alan Tippins</a>.</p>
    <ul class="social">
      <li><a href="https://twitter.com/lotus_rb" target="_blank" class="icon-twitter"></a></li>
      <li><a href="https://github.com/lotus" target="_blank" class="icon-github"></a></li>
    </ul>
  </div>
</footer>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="javascripts/vendor/jquery-1.11.2.min.js"><\/script>')</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.min.js"></script>

<script src="/javascripts/application.js" type="text/javascript"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47369640-1', 'lotusrb.org');
  ga('send', 'pageview');
</script>

  </body>
</html>
